<!doctype html>
<html lang="en">
  <head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@master/en/v6.5.0/css/ol.css" type="text/css">
    <style>
      html, body {
        height: 100%;
      }
      .map {
        height: 98%;
        width: 100%;
      }
    </style>
    <script src="https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@master/en/v6.5.0/build/ol.js"></script>
    <title>OpenLayers example</title>
  </head>
  <body>
    <div><button id="find-me">Show my location</button><spna id="status"></spna></div>
    <div id="map" class="map"></div>
    <script type="text/javascript">
      var map = new ol.Map({
        target: 'map',
        layers: [
          new ol.layer.Tile({
            source: new ol.source.OSM()
          })
        ],
        view: new ol.View({
          center: ol.proj.fromLonLat([38.41, 8.82]),
          zoom: 4
        })
      });

      function geoFindMe() {

        const status = document.querySelector('#status');
        // const mapLink = document.querySelector('#map-link');

        // mapLink.href = '';
        // mapLink.textContent = '';

        function success(position) {
          const latitude  = position.coords.latitude;
          const longitude = position.coords.longitude;
          const heading = position.coords.heading;

          // alert("lat:" + latitude + " / lon:" + longitude + " / heading:" + heading );
          status.textContent = "lat:" + latitude + " / lon:" + longitude + " / heading:" + heading;
          if (heading) {
            map.getView().setRotation(heading);
          }
          if (latitude && longitude) {
            map.getView().setCenter(ol.proj.fromLonLat([longitude, latitude]));
          }
          // status.textContent = '';
          // mapLink.href = `https://www.openstreetmap.org/#map=18/${latitude}/${longitude}`;
          // mapLink.textContent = `Latitude: ${latitude} °, Longitude: ${longitude} °`;
        }

        function error() {
          status.textContent = 'Unable to retrieve your location';
        }

        if(!navigator.geolocation) {
          status.textContent = 'Geolocation is not supported by your browser';
        } else {
          status.textContent = 'Locating…';
          // navigator.geolocation.getCurrentPosition(success, error);
          navigator.geolocation.watchPosition(success, error);
        }

      }

      document.querySelector('#find-me').addEventListener('click', geoFindMe);
    </script>
  </body>
</html>